#!/bin/bash -e

. k8s-read-config

echo "Deleting ConfigMaps"
for CONFIGMAP_FILE in "${CONFIGMAP_FILES[@]}"
do
  kubectl delete -f $CONFIGMAP_FILE --namespace=$NAMESPACE || true
done
echo "Done deleting ConfigMaps"

echo "Deleting Secrets"
for SECRET_FILE in "${SECRET_FILES[@]}"
do
  kubectl delete -f $SECRET_FILE --namespace=$NAMESPACE || true
done
echo "Done deleting Secrets"

echo "Deleting Blocking Jobs"
for index in "${!BLOCKING_JOBS_FILES[@]}"
do
  BLOCKING_JOB_FILE=${BLOCKING_JOBS_FILES[$index]}
  kubectl delete -f $BLOCKING_JOB_FILE --namespace=$NAMESPACE || true
done
echo "Done deleting Blocking Jobs"

echo "Deleting Jobs"
for index in "${!JOBS_FILES[@]}"
do
  JOB_FILE=${JOBS_FILES[$index]}
  kubectl delete -f $JOB_FILE --namespace=$NAMESPACE || true
done
echo "Done deleting Jobs"
echo ""

echo "Deleting Services"
for SERVICE_FILE in "${SERVICE_FILES[@]}"
do
  kubectl delete -f $SERVICE_FILE --namespace=$NAMESPACE || true
done
echo "Done deleting Services"
echo ""

echo "Deleting Ingress Resources"
for index in "${!INGRESS_FILES[@]}"
do
  INGRESS_FILE=${INGRESS_FILES[$index]}
  kubectl delete -f $INGRESS_FILE --namespace=$NAMESPACE || true
done
echo "Done deleting Ingress Resources"

echo "Deleting Deployments"
for DEPLOYMENT_FILE in "${DEPLOYMENT_FILES[@]}"
do
  kubectl delete -f $DEPLOYMENT_FILE --namespace=$NAMESPACE || true
done
echo "Done deleting Deployments"
echo ""
