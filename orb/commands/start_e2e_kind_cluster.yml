description: Start a kind cluster
parameters:
  kind_version:
    description: "The kind version to use. See https://github.com/kubernetes-sigs/kind/releases"
    type: string
    default: "0.4.0"
  kind_node_image:
    description: "The kind node image to use.  See https://github.com/kubernetes-sigs/kind/releases"
    type: string
    default: "kindest/node:v1.13.7@sha256:f3f1cfc2318d1eb88d91253a9c5fa45f6e9121b6b1e65aea6c7ef59f1549aaaf"
steps:
  - run: |
      curl -LO https://github.com/kubernetes-sigs/kind/releases/download/v<< parameters.kind_version >>/kind-linux-amd64
      chmod +x kind-linux-amd64
      mv kind-linux-amd64 /usr/local/bin/kind

      kind create cluster --name="e2e" --image << parameters.kind_node_image >> --wait=120s
